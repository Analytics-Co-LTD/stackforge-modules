# PostgreSQL + pgAdmin Environment

# PROMPT: label="PostgreSQL database name" example="analytics_dwh"
POSTGRES_DB={{ env.POSTGRES_DB | default('analytics_dwh') }}

# PROMPT: label="PostgreSQL admin user" example="dwh_admin"
POSTGRES_USER={{ env.POSTGRES_USER | default('dwh_admin') }}

# PROMPT: label="PostgreSQL admin password" required=true secret=true
POSTGRES_PASSWORD={{ password(24) }}

# PROMPT: label="pgAdmin email" required=true example="admin@analytics.co"
PGADMIN_DEFAULT_EMAIL={{ env.PGADMIN_DEFAULT_EMAIL | default('admin@analytics.co') }}

# PROMPT: label="pgAdmin password" required=true secret=true
PGADMIN_DEFAULT_PASSWORD={{ password(20) }}

# Instance identifiers (provided by StackForge)
INSTANCE_NAME={{ instance_name }}
COMPOSE_PROJECT_NAME={{ env.COMPOSE_PROJECT_NAME | default(instance_name) }}

# Network ports with environment-based defaults
# DEV: 5433/5050, STAGING: 5543/5150, PROD: 5443/5250
{% if environment == 'staging' %}
DWH_DB_PORT={{ env.DWH_DB_PORT | default('5543') }}
PGADMIN_PORT={{ env.PGADMIN_PORT | default('5150') }}
{% elif environment == 'prod' %}
DWH_DB_PORT={{ env.DWH_DB_PORT | default('5443') }}
PGADMIN_PORT={{ env.PGADMIN_PORT | default('5250') }}
{% else %}
DWH_DB_PORT={{ env.DWH_DB_PORT | default('5433') }}
PGADMIN_PORT={{ env.PGADMIN_PORT | default('5050') }}
{% endif %}

# Memory limits/reservations with environment-based defaults
{% if environment == 'prod' %}
DWH_DB_MEMORY_LIMIT={{ env.DWH_DB_MEMORY_LIMIT | default('2g') }}
DWH_DB_MEMORY_RESERVATION={{ env.DWH_DB_MEMORY_RESERVATION | default('1g') }}
PGADMIN_MEMORY_LIMIT={{ env.PGADMIN_MEMORY_LIMIT | default('1g') }}
PGADMIN_MEMORY_RESERVATION={{ env.PGADMIN_MEMORY_RESERVATION | default('512m') }}
{% elif environment == 'staging' %}
DWH_DB_MEMORY_LIMIT={{ env.DWH_DB_MEMORY_LIMIT | default('1.5g') }}
DWH_DB_MEMORY_RESERVATION={{ env.DWH_DB_MEMORY_RESERVATION | default('768m') }}
PGADMIN_MEMORY_LIMIT={{ env.PGADMIN_MEMORY_LIMIT | default('768m') }}
PGADMIN_MEMORY_RESERVATION={{ env.PGADMIN_MEMORY_RESERVATION | default('384m') }}
{% else %}
DWH_DB_MEMORY_LIMIT={{ env.DWH_DB_MEMORY_LIMIT | default('1g') }}
DWH_DB_MEMORY_RESERVATION={{ env.DWH_DB_MEMORY_RESERVATION | default('512m') }}
PGADMIN_MEMORY_LIMIT={{ env.PGADMIN_MEMORY_LIMIT | default('512m') }}
PGADMIN_MEMORY_RESERVATION={{ env.PGADMIN_MEMORY_RESERVATION | default('256m') }}
{% endif %}
